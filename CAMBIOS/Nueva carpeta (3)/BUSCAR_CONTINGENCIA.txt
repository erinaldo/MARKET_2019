

/****** Object:  StoredProcedure [dbo].[BUSCAR_CONTINGENCIA]    Script Date: 09/04/2019 16:07:54 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[BUSCAR_CONTINGENCIA]
@ID_VENTASM BIGINT
 AS
SELECT     VENTAS_MANUAL.COD_DOC, VENTAS_MANUAL.SERIE_VENTASM, VENTAS_MANUAL.NUMERO_VENTASM, VENTAS_MANUAL.FECHA_VENTASM, ISNULL(VENTAS_MANUAL.COD_CLIENTE, '0') 
                      AS COD_CLIENTE, ISNULL(CLIENTES.DESC_CLIENTE, '') AS DESC_CLIENTE, VENTAS_MANUAL.PIGV, VENTAS_MANUAL.SUBTOTAL_VENTASM, VENTAS_MANUAL.IGV_VENTASM, 
                      VENTAS_MANUAL.TOTAL_VENTASM, VENTAS_MANUAL.STAT_VENTASM, ISNULL(VENTAS_MANUAL.COD_MCONTINGENCIA, 0) AS COD_MCONTINGENCIA, 
                      ISNULL(MOTIVO_CONTINGENCIA.DESC_MCONTINGENCIA, '') AS DESC_MCONTINGENCIA, CLIENTES.RUC_CLIENTE, CLIENTES.DNI_CLIENTE
FROM         VENTAS_MANUAL INNER JOIN
                      CLIENTES ON VENTAS_MANUAL.COD_CLIENTE = CLIENTES.COD_CLIENTE LEFT OUTER JOIN
                      MOTIVO_CONTINGENCIA ON VENTAS_MANUAL.COD_MCONTINGENCIA = MOTIVO_CONTINGENCIA.COD_MCONTINGENCIA
WHERE     (VENTAS_MANUAL.ID_VENTASM = @ID_VENTASM)

GO


