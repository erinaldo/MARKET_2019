
/****** Object:  StoredProcedure [dbo].[IAM_GENERAR_DETALLE_TXT]    Script Date: 03/11/2018 20:55:21 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[IAM_GENERAR_DETALLE_TXT]    
@COD_DOC CHAR(3),@NRODOCU NUMERIC(10,0)
  AS        
BEGIN        
SELECT     VENTADET.ITEM, VENTADET.COD_ART AS AMO2ART, VENTADET.CANTIDAD AS AMO2CANTI, ARTICULOS.DESC_ART AS AARTDESC,
CONVERT(NUMERIC(18,2),(CANTIDAD*(PRECIO-PRECIO*ISNULL(DSCTO_PORC,0)/100))/ (1 + CONVERT(NUMERIC(18,2),VAL_IGV) / 100)) AS AMO2STOT,
CONVERT(NUMERIC(18, 2),
 (PRECIO-(PRECIO*ISNULL(DSCTO_PORC,0)/100))/(1+CONVERT(NUMERIC(18,2),VAL_IGV)/100)
)
  AS AMO2PREC,'NIU' AS AUMESUNAT,PRECIO AS AVTAPREC
FROM         VENTADET INNER JOIN
                      ARTICULOS ON VENTADET.COD_ART = ARTICULOS.COD_ART INNER JOIN
                      VENTACAB ON VENTADET.COD_DOC = VENTACAB.COD_DOC AND VENTADET.NRODOCU = VENTACAB.NRODOCU
WHERE     (VENTACAB.COD_DOC = @COD_DOC) AND VENTACAB.NRODOCU=@NRODOCU

END 



