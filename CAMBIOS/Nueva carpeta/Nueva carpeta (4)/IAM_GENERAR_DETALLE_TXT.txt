USE [MARKET]
GO
/****** Object:  StoredProcedure [dbo].[IAM_GENERAR_DETALLE_TXT]    Script Date: 09/27/2018 14:55:59 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


ALTER PROCEDURE [dbo].[IAM_GENERAR_DETALLE_TXT]    
@COD_DOC CHAR(3),@NRODOCU NUMERIC(10,0)
  AS        
BEGIN        
SELECT     VENTADET.ITEM, VENTADET.COD_ART AS AMO2ART, VENTADET.CANTIDAD AS AMO2CANTI, ARTICULOS.DESC_ART AS AARTDESC, CONVERT(NUMERIC(18, 2), 
                      (VENTADET.CANTIDAD * (VENTADET.PRECIO - VENTADET.PRECIO * ISNULL(VENTADET.DSCTO_PORC, 0) / 100)) / (1 + CONVERT(NUMERIC(18, 2), VENTACAB.VAL_IGV) 
                      / 100)) AS AMO2STOT, CONVERT(NUMERIC(18, 2), (VENTADET.PRECIO - VENTADET.PRECIO * ISNULL(VENTADET.DSCTO_PORC, 0) / 100) / (1 + CONVERT(NUMERIC(18,
                       2), VENTACAB.VAL_IGV) / 100)) AS AMO2PREC, 'NIU' AS AUMESUNAT, VENTADET.PRECIO AS AVTAPREC, 
                       ISNULL(ARTICULOS.COD_SUNAT,'') AS COD_SUNAT
FROM         VENTADET INNER JOIN
                      ARTICULOS ON VENTADET.COD_ART = ARTICULOS.COD_ART INNER JOIN
                      VENTACAB ON VENTADET.COD_DOC = VENTACAB.COD_DOC AND VENTADET.NRODOCU = VENTACAB.NRODOCU
WHERE     (VENTACAB.COD_DOC = @COD_DOC) AND (VENTACAB.NRODOCU = @NRODOCU)

END 




