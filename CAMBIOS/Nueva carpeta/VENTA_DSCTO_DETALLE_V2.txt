USE [MARKET]
GO
/****** Object:  StoredProcedure [dbo].[VENTA_DSCTO_DETALLE]    Script Date: 03/10/2018 20:48:33 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[VENTA_DSCTO_DETALLE_V2]
@IDTMP INT,
@CORR FLOAT,
@DESC FLOAT,
@CANT INT,
@TIPO CHAR(1),
@SW INT OUTPUT

 AS

 BEGIN TRAN	
	SET @SW=0
	IF @TIPO='U'
		BEGIN
			UPDATE DETALLETMP SET CANT_TMP=@CANT,DSCTO_PORC=@DESC,DSCTO_MONTO=0 WHERE ID_TMP=@IDTMP
		END
	ELSE
		BEGIN
			UPDATE DETALLETMP SET CANT_TMP=@CANT,DSCTO_PORC=@DESC,DSCTO_MONTO=0 WHERE CORR_TMP=@CORR
		END

	 IF (@@ERROR!=0)
	    BEGIN
		--RAISERROR 2000 'error actualizando datos'
		ROLLBACK TRAN
		SET @SW=1
	        RETURN(1)

	    END
	
    COMMIT TRAN