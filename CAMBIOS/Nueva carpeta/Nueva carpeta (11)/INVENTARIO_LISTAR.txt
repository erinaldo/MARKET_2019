USE [MARKET_CELESTE]
GO
/****** Object:  StoredProcedure [dbo].[MOVIMIENTO_LISTAR]    Script Date: 01/02/2019 15:50:48 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
create PROCEDURE [dbo].[INVENTARIO_LISTAR]
@CAD VARCHAR(250), @FI VARCHAR(8),@FF VARCHAR(8), @TIPO CHAR(1)
AS

DECLARE @CADENA VARCHAR(4500)

SET @CADENA="SELECT     INVENTARIO.COD_INV as Cod, INVENTARIO.FECHA_INV as Fecha, ALMACENES.DESC_ALMACEN as Almacen, 
CASE WHEN INVENTARIO.STAT_INV = 1 THEN 'ANULADO' ELSE '' END AS Estado 

FROM         INVENTARIO INNER JOIN
                      ALMACENES ON INVENTARIO.COD_ALMACEN = ALMACENES.COD_ALMACEN"+
	" WHERE FECHA_INV BETWEEN '"+@FI+"' AND '"+@FF+"'"

IF @TIPO='E' SET @CADENA=@CADENA+" AND STAT_INV=0"
IF @TIPO='A' SET @CADENA=@CADENA+" AND STAT_INV=1"

SET @CADENA=@CADENA+@CAD


PRINT @CADENA
EXEC(@CADENA)