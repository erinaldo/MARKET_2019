USE [MARKET_CELESTE]
GO
/****** Object:  UserDefinedFunction [dbo].[BUSCAR_COSTO]    Script Date: 01/02/2019 15:13:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO


ALTER FUNCTION [dbo].[BUSCAR_COSTO_ANT] 
(@CODIGO CHAR(15),
 @FECHA CHAR(8))
 
RETURNS NUMERIC(18,4)
BEGIN 

	DECLARE @PAGOS NUMERIC(18,4)
	
	SELECT @PAGOS=COSTO_KARDEX from kardex where CODIGO=@CODIGO AND FECHA_KARDEX<=@FECHA ORDER BY FECHA_KARDEX DESC,ITEM DESC
	SET @PAGOS=ISNULL(@PAGOS,0)
	RETURN @PAGOS
END






