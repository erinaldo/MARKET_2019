USE [MARKET_CELESTE]
GO
/****** Object:  StoredProcedure [dbo].[LISTAR_PROVEEDORES]    Script Date: 11/28/2018 14:32:08 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER PROCEDURE [dbo].[LISTAR_PROVEEDORES]
	@SW INT,@CADENA VARCHAR(250),@CAMPO VARCHAR(250)
  AS
BEGIN
	DECLARE @CAD VARCHAR(2500)
	
	SET @CAD="SELECT COD_PROVED AS CODIGO, DESC_PROVED AS DESCRIPCION,CASE WHEN STAT_PROVED=1 THEN 'ANULADO'  ELSE '' END AS ESTADO, "+
		" RUC_PROVED,DIR_PROVED,	TELF_PROVED,TELF2_PROVED,CONTACTO_PROVED,ISNULL(PERCEP_PROVED,0) AS PERCEP_PROVED "+
		" FROM PROVEEDORES WHERE STAT_PROVED<>3 "
	--TODOS
	PRINT @SW
	IF @SW<>2  SET @CAD=@CAD+"AND STAT_PROVED="+CONVERT(CHAR(1),@SW)+""

	--CAMPO A BUSCAR
	IF @CADENA<>'' SET @CAD=@CAD+" AND "+@CAMPO+" LIKE '%"+@CADENA+"%'" 

	
	SET @CAD=@CAD+" ORDER BY DESC_PROVED ASC"

	PRINT @CAD
	EXEC(@CAD)
END