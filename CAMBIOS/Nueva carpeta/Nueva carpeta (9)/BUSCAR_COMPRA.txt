USE [MARKET_CELESTE]
GO
/****** Object:  StoredProcedure [dbo].[BUSCAR_COMPRA]    Script Date: 11/28/2018 15:07:07 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER PROCEDURE [dbo].[BUSCAR_COMPRA]

@ID INT

 AS
SELECT     COMPRAS.ID_COMPRA, COMPRAS.cod_doc, TIPO_DOC.DESC_DOC, COMPRAS.serie_COMPRA, COMPRAS.num_COMPRA, COMPRAS.fecha_COMPRA, 
                      COMPRAS.VENC_COMPRA, COMPRAS.COD_PROVED, PROVEEDORES.DESC_PROVED, COMPRAS.MON_COMPRA, COMPRAS.TC_COMPRA, COMPRAS.INC_COMPRA, 
                      COMPRAS.COD_FP, Forma_Pago.DESC_FP, COMPRAS.OBS_COMPRA, Detalle_Compras.FILA_DC, Detalle_Compras.cod_art, ARTICULOS.DESC_ART, 
                      ARTICULOS.COD_MEDIDA, MEDIDA.DESC_MEDIDA, Detalle_Compras.cant_DC, Detalle_Compras.PU_DC, COMPRAS.PAGOS_COMPRA, COMPRAS.COD_ALMACEN, 
                      ALMACENES.DESC_ALMACEN, ISNULL(COMPRAS.NRO_PERCEP,'') AS NRO_PERCEP, ISNULL(COMPRAS.PERCEP_COMPRA,0) AS PERCEP_COMPRA
FROM         COMPRAS INNER JOIN
                      Detalle_Compras ON COMPRAS.ID_COMPRA = Detalle_Compras.ID_COMPRA INNER JOIN
                      TIPO_DOC ON COMPRAS.cod_doc = TIPO_DOC.COD_DOC INNER JOIN
                      PROVEEDORES ON COMPRAS.COD_PROVED = PROVEEDORES.COD_PROVED INNER JOIN
                      ARTICULOS ON Detalle_Compras.cod_art = ARTICULOS.COD_ART INNER JOIN
                      Forma_Pago ON COMPRAS.COD_FP = Forma_Pago.COD_FP INNER JOIN
                      ALMACENES ON COMPRAS.COD_ALMACEN = ALMACENES.COD_ALMACEN LEFT OUTER JOIN
                      MEDIDA ON ARTICULOS.COD_MEDIDA = MEDIDA.COD_MEDIDA
WHERE     (COMPRAS.ID_COMPRA = @ID)
ORDER BY Detalle_Compras.FILA_DC