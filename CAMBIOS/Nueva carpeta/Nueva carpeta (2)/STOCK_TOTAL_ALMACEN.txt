
/****** Object:  UserDefinedFunction [dbo].[STOCK_TOTAL_ALMACEN]    Script Date: 04/30/2018 17:22:06 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO


CREATE FUNCTION [dbo].[STOCK_TOTAL_ALMACEN] 
(@COD_ART CHAR(15),@COD_ALMACEN BIGINT) 
RETURNS FLOAT
BEGIN 

	DECLARE @STOCK FLOAT

	SELECT @STOCK=SUM(CASE TIPO_MOV WHEN 'Ingreso' THEN cant_KARDEX ELSE 0 END)- SUM(CASE TIPO_MOV WHEN 'Salida' THEN cant_KARDEX ELSE 0 END) 
	FROM Kardex WHERE (CODIGO =@COD_ART) AND COD_ALMACEN=@COD_ALMACEN

	SET @STOCK=ISNULL(@STOCK,0)

	RETURN @STOCK
END



