USE [MARKET]
GO
/****** Object:  StoredProcedure [dbo].[VENTA_MOSTRAR_DETALLE]    Script Date: 04/07/2019 13:10:45 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER PROCEDURE [dbo].[VENTA_MOSTRAR_DETALLE]
@COD_DOC char(3),@NRODOCU NUMERIC
 AS

SELECT     TOP 100 PERCENT dbo.VENTADET.ITEM, dbo.VENTADET.COD_ART AS Codigo, dbo.ARTICULOS.DESC_ART AS Descripcion, 
                      dbo.MEDIDA.DESC_MEDIDA AS Medida, dbo.VENTADET.CANTIDAD AS Cantidad, dbo.VENTADET.PRECIO AS Pu, 
                      --dbo.VENTADET.PRECIO * dbo.VENTADET.CANTIDAD AS Total,
  	VENTADET.PRECIO * VENTADET.CANTIDAD-
		(dbo.VENTADET.PRECIO * dbo.VENTADET.CANTIDAD*ISNULL(DSCTO_PORC,0)/100)-
		(ISNULL(DSCTO_MONTO,0)) AS Total,
	DSCTO_PORC AS 'Dscto %', DSCTO_MONTO AS 'Dscto #'
	,ISNULL(DSCTO_PORC,0) AS DSCTO_PORC,ISNULL(DSCTO_MONTO,0) AS DSCTO_MONTO,VENTADET.PRECIO * VENTADET.CANTIDAD AS TOTALSD,
	 'NIU' AS AUMESUNAT,ISNULL(ARTICULOS.COD_SUNAT,'') AS COD_SUNAT
FROM         dbo.ARTICULOS INNER JOIN
                      dbo.MEDIDA ON dbo.ARTICULOS.COD_MEDIDA = dbo.MEDIDA.COD_MEDIDA INNER JOIN
                      dbo.VENTADET ON dbo.ARTICULOS.COD_ART = dbo.VENTADET.COD_ART
	WHERE COD_DOC=@COD_DOC AND NRODOCU=@NRODOCU
ORDER BY VENTADET.ITEM